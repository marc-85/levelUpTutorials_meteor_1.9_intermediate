"use strict";

var _SimpleSchema = require("./SimpleSchema");

var _expect = _interopRequireDefault(require("expect"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/* eslint-disable func-names, prefer-arrow-callback */
describe('SimpleSchema', function () {
  describe('getObjectSchema', function () {
    it('top level object', function () {
      const schema = new _SimpleSchema.SimpleSchema({
        foo: Object,
        'foo.aaa': {
          type: String,
          optional: true
        },
        'foo.bbb': {
          type: Object,
          optional: true
        },
        'foo.bbb.zzz': {
          type: Number
        }
      });
      const newSchema = schema.getObjectSchema('foo');
      (0, _expect.default)(newSchema.mergedSchema()).toEqual({
        aaa: {
          type: _SimpleSchema.SimpleSchema.oneOf(String),
          label: 'Aaa',
          optional: true
        },
        bbb: {
          type: _SimpleSchema.SimpleSchema.oneOf(Object),
          label: 'Bbb',
          optional: true
        },
        'bbb.zzz': {
          type: _SimpleSchema.SimpleSchema.oneOf(Number),
          label: 'Zzz',
          optional: false
        }
      });
    });
    it('second level object', function () {
      const schema = new _SimpleSchema.SimpleSchema({
        foo: Object,
        'foo.aaa': {
          type: String,
          optional: true
        },
        'foo.bbb': {
          type: Object,
          optional: true
        },
        'foo.bbb.zzz': {
          type: Number
        }
      });
      const newSchema = schema.getObjectSchema('foo.bbb');
      (0, _expect.default)(newSchema.mergedSchema()).toEqual({
        zzz: {
          type: _SimpleSchema.SimpleSchema.oneOf(Number),
          label: 'Zzz',
          optional: false
        }
      });
    });
    it('object in array', function () {
      const schema = new _SimpleSchema.SimpleSchema({
        foo: Object,
        'foo.aaa': {
          type: Array,
          optional: true
        },
        'foo.aaa.$': {
          type: Object
        },
        'foo.aaa.$.zzz': {
          type: String,
          optional: true
        },
        'foo.aaa.$.yyy': {
          type: Boolean
        }
      });
      const newSchema = schema.getObjectSchema('foo.aaa.$');
      (0, _expect.default)(newSchema.mergedSchema()).toEqual({
        zzz: {
          type: _SimpleSchema.SimpleSchema.oneOf(String),
          label: 'Zzz',
          optional: true
        },
        yyy: {
          type: _SimpleSchema.SimpleSchema.oneOf(Boolean),
          label: 'Yyy',
          optional: false
        }
      });
    });
    it('subschema', function () {
      const schema = new _SimpleSchema.SimpleSchema({
        foo: new _SimpleSchema.SimpleSchema({
          aaa: {
            type: String,
            optional: true
          },
          bbb: {
            type: Object,
            optional: true
          },
          'bbb.zzz': {
            type: Number
          }
        })
      });
      const newSchema = schema.getObjectSchema('foo');
      (0, _expect.default)(newSchema.mergedSchema()).toEqual({
        aaa: {
          type: _SimpleSchema.SimpleSchema.oneOf(String),
          label: 'Aaa',
          optional: true
        },
        bbb: {
          type: _SimpleSchema.SimpleSchema.oneOf(Object),
          label: 'Bbb',
          optional: true
        },
        'bbb.zzz': {
          type: _SimpleSchema.SimpleSchema.oneOf(Number),
          label: 'Zzz',
          optional: false
        }
      });
    });
  });
});